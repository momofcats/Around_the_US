(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{21:function(e,t,n){},23:function(e,t,n){e.exports=n.p+"static/media/logo.8f7611ae.svg"},25:function(e,t,n){e.exports=n.p+"static/media/success.e38b395c.svg"},26:function(e,t,n){e.exports=n.p+"static/media/faliure.4072126c.svg"},29:function(e,t,n){e.exports=n(41)},34:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(22),c=n.n(r),i=(n(34),n(27)),u=n(1),s=n(2),l=n(23),m=n.n(l),p=n(7);var _=function(e){return o.a.createElement("nav",{className:"menu"},"/signup"===e.route&&o.a.createElement(p.c,{className:"menu__item",to:"/signin"},"Log in"),"/signin"===e.route&&o.a.createElement(p.c,{exact:!0,className:"menu__item",to:"/signup"},"Sign up"))};var d=function(e){return o.a.createElement("header",{className:"header"},o.a.createElement("img",{src:m.a,alt:"logo",className:"header__logo"}),e.loggedIn?o.a.createElement("div",{className:"header__wrapper"},o.a.createElement("p",null,e.userEmail),o.a.createElement("button",{onClick:e.onLogOut,className:"header__btn button"},"Log out")):o.a.createElement(_,{onLogOut:e.onLogOut,loggedIn:e.loggedIn,route:e.route}))},f=Object(a.createContext)();var b=function(e){var t=o.a.useContext(f),n=e.card,a=n.owner._id===t._id,r=n.likes.some((function(e){return e._id===t._id}))?"card__like card__like_active":"card__like";return o.a.createElement("li",{className:"card"},a?o.a.createElement("button",{type:"button",className:"button card__del",onClick:function(){e.onCardDelete(n)}}):"",o.a.createElement("div",{className:"card__img",style:{backgroundImage:"url(".concat(n.link,")")},onClick:function(){e.onCardClick(n)}}),o.a.createElement("div",{className:"card__description-wrapper"},o.a.createElement("h2",{className:"card__title"},n.name),o.a.createElement("div",{className:"card__likes-container"},o.a.createElement("button",{className:"".concat(r," button "),onClick:function(){e.onCardLike(n)}}),o.a.createElement("p",{className:"card__likes"},n.likes.length))))};var h=function(e){var t=o.a.useContext(f);return o.a.createElement("main",null,o.a.createElement("section",{className:"profile page__section"},o.a.createElement("div",{className:"media"},o.a.createElement("div",{className:"media__image-container"},o.a.createElement("img",{alt:"profile",className:"media__image",src:t.avatar}),o.a.createElement("button",{onClick:e.onEditAvatar,className:"media__btn media__btn_size_lg media__btn_hoverable",type:"button"})),o.a.createElement("div",{className:"media__body"},o.a.createElement("div",{className:"media__item"},o.a.createElement("h1",{className:"media__name"},t.name),o.a.createElement("button",{onClick:e.onEditProfile,className:"media__btn media__btn_size_sm button",type:"button"})),o.a.createElement("p",{className:"media__job"},t.about))),o.a.createElement("button",{onClick:e.onAddPlace,className:"profile__btn button",type:"button"})),o.a.createElement("ul",{className:"gallery page__section"},e.cards.map((function(t,n){return o.a.createElement(b,{key:n,card:t,onCardDelete:e.onCardDelete,onCardClick:e.onCardClick,onCardLike:e.onCardLike})}))))};var g=function(){return o.a.createElement("footer",{className:"footer page__section"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Around The U.S."))};var E=function(e){return o.a.createElement("form",{className:"form",action:"#",noValidate:!0,name:e.name,onSubmit:e.onSubmit},e.children,e.name&&o.a.createElement("button",{className:"form__submit-btn ".concat("login"===e.name||"register"===e.name?"form__submit-btn_theme_light":"form__submit-btn_theme_dark"),type:"submit","data-text":"Save",onSubmit:e.onSubmit},e.buttonText))},v=(n(21),n(11)),O=n.n(v),j=n(18),k=n(13),C=n(14),N=new(function(){function e(t){Object(k.a)(this,e),this.options=t}return Object(C.a)(e,[{key:"register",value:function(e){return this.request("/signup","POST",JSON.stringify(e))}},{key:"authorize",value:function(e){return this.request("/signin","POST",JSON.stringify(e))}},{key:"getContent",value:function(e){return fetch("https://register.nomoreparties.co/users/me",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(function(){var e=Object(j.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=2;break}return e.abrupt("return",t.json());case 2:return e.next=4,t.json();case 4:return n=e.sent,e.abrupt("return",Promise.reject(n.error||n.message));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"request",value:function(e,t,n){return fetch("".concat(this.options.baseUrl).concat(e),{headers:{"Content-Type":"application/json"},method:t,body:n}).then(function(){var e=Object(j.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=2;break}return e.abrupt("return",t.json());case 2:return e.next=4,t.json();case 4:return n=e.sent,e.abrupt("return",Promise.reject(n.error||n.message));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}]),e}())({baseUrl:"https://register.nomoreparties.co"});var y=function(e){var t=Object(a.useState)(""),n=Object(u.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(""),l=Object(u.a)(i,2),m=l[0],_=l[1],d=Object(s.g)(),f=function(){c(""),_("")};return Object(a.useEffect)((function(){localStorage.getItem("jwt")&&d.push("/")}),[d]),o.a.createElement("section",{className:"authentication page__section"},o.a.createElement("div",{className:"authentication__container"},o.a.createElement("h2",{className:"authentication__title"},e.title),o.a.createElement(E,{name:"login",title:"Log in",buttonText:"Log in",onSubmit:function(t){t.preventDefault(),r&&m&&N.authorize({email:r,password:m}).then((function(t){localStorage.setItem("jwt",t.token),e.onLogin()})).then(f).then((function(){return d.push("/")})).catch((function(e){console.log(e)}))}},o.a.createElement("input",{className:"form__input form__input_theme_dark",placeholder:"Email",type:"email",required:!0,value:r,onChange:function(e){return c(e.target.value)}}),o.a.createElement("input",{className:"form__input form__input_theme_dark",placeholder:"Password",type:"password",required:!0,value:m,onChange:function(e){return _(e.target.value)}})),o.a.createElement("div",{className:"authentication__nav"},o.a.createElement("span",null,"Not a member yet?"),o.a.createElement(p.b,{className:"authentication__link",to:"/signup"},"Sign up here!"))))};var S=function(e){var t=Object(a.useState)(""),n=Object(u.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(""),l=Object(u.a)(i,2),m=l[0],_=l[1],d=Object(s.g)(),f=function(){c(""),_("")};return Object(a.useEffect)((function(){localStorage.getItem("jwt")&&d.push("/")}),[d]),o.a.createElement("section",{className:"authentication page__section"},o.a.createElement("div",{className:"authentication__container"},o.a.createElement("h2",{className:"authentication__title"},e.title),o.a.createElement(E,{name:"register",title:"Sing up",buttonText:"Sign up",onSubmit:function(t){t.preventDefault(),N.register({email:r,password:m}).then(f).then((function(){d.push("/signin"),e.onSuccess()})).catch((function(t){console.log(t),e.onFail()}))}},o.a.createElement("input",{name:"email",className:"form__input form__input_theme_dark",placeholder:"Email",type:"email",required:!0,value:r,onChange:function(e){return c(e.target.value)}}),o.a.createElement("input",{name:"password",className:"form__input form__input_theme_dark",placeholder:"Password",type:"password",required:!0,value:m,onChange:function(e){return _(e.target.value)}})),o.a.createElement("div",{className:"authentication__nav"},o.a.createElement("span",null,"Already a member?"),o.a.createElement(p.b,{className:"authentication__link",to:"/signin"},"Login here!"))))};var w=function(e){return o.a.createElement("div",{className:"popup js-popup-".concat(e.name," ").concat(e.isOpen?"popup_role_show popup_background_light":"popup_role_fade-out"),onClick:function(t){t.target.classList.contains("popup_role_show")&&e.onClose()}},o.a.createElement("div",{className:"popup__container popup__container_type_form"},o.a.createElement("h2",{className:"popup__title"},e.title),o.a.createElement("button",{className:"popup__btn-close button",type:"button",onClick:e.onClose}),o.a.createElement(E,{name:e.name,onSubmit:e.onSubmit,buttonText:e.buttonText},e.children)))};var x=function(e){var t=Object(a.useState)(""),n=Object(u.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(""),s=Object(u.a)(i,2),l=s[0],m=s[1],p=Object(a.useContext)(f);function _(e){var t=e.target,n=t.name,a=t.value;switch(n){case"name":c(a);break;case"about":m(a)}}return Object(a.useEffect)((function(){p.name&&c(p.name),p.about&&m(p.about)}),[p]),o.a.createElement(w,{name:"profile",title:"Edit profile",buttonText:"Save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:r,about:l})}},o.a.createElement("input",{required:!0,pattern:"[a-zA-Z\\s\\-]+",type:"text",value:r,className:"form__input form__input_theme_light js-input-name",name:"name",placeholder:"Name",onChange:_,minLength:"2",maxLength:"40"}),o.a.createElement("input",{required:!0,type:"text",value:l,className:"form__input form__input_theme_light js-input-job",name:"about",placeholder:"About me",onChange:_,minLength:"2",maxLength:"200"}))};var L=function(e){var t=Object(a.useRef)(null);return o.a.createElement(w,{name:"change-avatar",title:"Change profile picture",buttonText:"Save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})}},o.a.createElement("input",{type:"url",className:"form__input form__input_theme_light js-input-link",name:"avatar",placeholder:"Url",ref:t,required:!0}))};var I=function(e){var t=Object(a.useRef)(null),n=Object(a.useRef)(null);return o.a.createElement(w,{name:"photo-form",title:"New Place",buttonText:"Create",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onAddPlace({name:n.current.value,link:t.current.value})}},o.a.createElement("input",{type:"text",ref:n,className:"form__input form__input_theme_light js-input-title",name:"name",placeholder:"Title",minLength:"1",maxLength:"30",required:!0}),o.a.createElement("input",{ref:t,type:"url",className:"form__input form__input_theme_light js-input-link",name:"link",placeholder:"Image link",required:!0}))};var T=function(e){var t=e.card;return o.a.createElement("div",{className:"popup popup_background_dark js-popup-picture ".concat(e.isOpen?"popup_role_show":"popup_role_fade-out"),onClick:function(t){t.target.classList.contains("popup_role_show")&&e.onClose()}},o.a.createElement("div",{className:"popup__container popup__container_type_picture"},o.a.createElement("button",{className:"popup__btn-close button",type:"button",onClick:e.onClose}),o.a.createElement("img",{className:"popup__image",src:t.link,alt:t.name}),o.a.createElement("h2",{className:"popup__subtitle"},t.name)))};var q=function(e){return o.a.createElement(w,{isOpen:e.isOpen,onClose:e.onClose},o.a.createElement("img",{src:e.icon,alt:"success",className:"popup__icon"}),o.a.createElement("p",{className:"popup__title page__centered"},e.text))},P=new(function(){function e(t){Object(k.a)(this,e),this.options=t}return Object(C.a)(e,[{key:"getInitialCards",value:function(){return this.request("/cards")}},{key:"getUserInfo",value:function(){return this.request("/users/me")}},{key:"getAppInfo",value:function(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}},{key:"addLike",value:function(e){return this.request("/cards/likes/".concat(e),"PUT")}},{key:"removeLike",value:function(e){return this.request("/cards/likes/".concat(e),"DELETE")}},{key:"delCard",value:function(e){return this.request("/cards/".concat(e),"DELETE")}},{key:"updateUserInfo",value:function(e){return this.request("/users/me","PATCH",JSON.stringify({name:e.name,about:e.about}))}},{key:"updateAvatar",value:function(e){return this.request("/users/me/avatar","PATCH",JSON.stringify({avatar:e.avatar}))}},{key:"postNewCard",value:function(e){return this.request("/cards/","POST",JSON.stringify({name:e.name,link:e.link}))}},{key:"request",value:function(e,t,n){return fetch("".concat(this.options.baseUrl).concat(e),{headers:{Authorization:"2ea24103-3839-4671-8e47-57675e6fba9c","Content-Type":"application/json"},method:t,body:n}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/group-2"}),A=n(28),U=function(e){var t=e.component,n=Object(A.a)(e,["component"]);return o.a.createElement(s.b,null,(function(){return n.loggedIn?o.a.createElement(t,n):o.a.createElement(s.a,{to:"/signin"})}))},D=n(25),z=n.n(D),J=n(26),B=n.n(J);var F=Object(s.i)((function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(!1),l=Object(u.a)(c,2),m=l[0],p=l[1],_=Object(a.useState)(!1),b=Object(u.a)(_,2),E=b[0],v=b[1],O=Object(a.useState)(!1),j=Object(u.a)(O,2),k=j[0],C=j[1],w=Object(a.useState)(!1),A=Object(u.a)(w,2),D=A[0],J=A[1],F=Object(a.useState)(!1),R=Object(u.a)(F,2),H=R[0],W=R[1],G=Object(a.useState)(0),M=Object(u.a)(G,2),V=M[0],Y=M[1],Z=Object(a.useState)({}),$=Object(u.a)(Z,2),K=$[0],Q=$[1],X=Object(a.useState)([]),ee=Object(u.a)(X,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(!1),oe=Object(u.a)(ae,2),re=oe[0],ce=oe[1],ie=Object(a.useState)(""),ue=Object(u.a)(ie,2),se=ue[0],le=ue[1],me=Object(a.useState)(!0),pe=Object(u.a)(me,2),_e=pe[0],de=pe[1],fe=Object(s.g)(),be=Object(s.h)();function he(e,t){var n=te.map((function(n){return n._id===e?t:n}));ne(n)}function ge(){v(!1),r(!1),p(!1),W(!1),J(!1),C(!1),Y(0)}function Ee(e){"Escape"===e.key&&ge()}return Object(a.useEffect)((function(){var e=localStorage.getItem("jwt");e?N.getContent(e).then((function(e){e&&(de(!1),ce(!0),le(e.data.email),fe.push("/"))})):de(!1)}),[fe,re]),Object(a.useEffect)((function(){re&&P.getUserInfo().then((function(e){Q(e)})).catch(console.log)}),[re]),Object(a.useEffect)((function(){re&&P.getInitialCards().then((function(e){ne(e)})).catch(console.log)}),[re]),Object(a.useEffect)((function(){return document.addEventListener("keydown",Ee),function(){document.removeEventListener("keydown",Ee)}})),_e?null:o.a.createElement(o.a.Fragment,null,o.a.createElement(d,{onLogOut:function(){localStorage.removeItem("jwt"),ce(!1),fe.push("/signin")},loggedIn:re,userEmail:se,route:be.pathname}),o.a.createElement(f.Provider,{value:K},o.a.createElement(s.d,null,o.a.createElement(s.b,{path:"/signin"},o.a.createElement(y,{onLogin:function(){ce(!0)},title:"Log in"})),o.a.createElement(s.b,{path:"/signup"},o.a.createElement(S,{title:"Sign up",onSuccess:function(){C(!0)},onFail:function(){J(!0)}})),o.a.createElement(U,{exact:!0,path:"/",loggedIn:re,component:h,onEditProfile:function(){r(!0)},onAddPlace:function(){p(!0)},onEditAvatar:function(){v(!0)},onCardClick:function(e){Y(e),W(!0)},cards:te,onCardDelete:function(e){P.delCard(e._id).then((function(t){var n=te.filter((function(t){return t._id!==e._id}));ne(n)}))},onCardLike:function(e){e.likes.some((function(e){return e._id===K._id}))?P.removeLike(e._id).then((function(t){he(e._id,t)})):P.addLike(e._id).then((function(t){he(e._id,t)}))}})),re&&o.a.createElement(g,null),o.a.createElement(x,{isOpen:n,onClose:ge,onUpdateUser:function(e){P.updateUserInfo(e).then((function(e){Q(e)})).catch(console.log),ge()}}),o.a.createElement(I,{isOpen:m,onClose:ge,onAddPlace:function(e){P.postNewCard(e).then((function(e){ne([e].concat(Object(i.a)(te)))})).catch(console.log),console.log(te),ge()}}),o.a.createElement(L,{isOpen:E,onClose:ge,onUpdateAvatar:function(e){P.updateAvatar(e).then((function(e){Q(e)})).catch(console.log),ge()}}),o.a.createElement(T,{isOpen:H,onClose:ge,card:V}),o.a.createElement(q,{isOpen:k,onClose:ge,icon:z.a,text:"Success! You have now been registered."}),o.a.createElement(q,{isOpen:D,onClose:ge,icon:B.a,text:"Oops, something went wrong! Please try again."})))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(p.a,{basename:"."},o.a.createElement(F,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[29,1,2]]]);
//# sourceMappingURL=main.6a7fb4e0.chunk.js.map